<h1 style="text-align:center"><%= @chat.request.shift.job.title %> on <%= @chat.request.shift.start_time %></h1>
<div class="container">
    <div class="card p-3" id="chat_section">
        <% @chat.messages.each do |message| %>
        <div class="d-flex">
          <p><%= message.user.first_name %>: <%= message.created_at.strftime("%H:%M") %></p>
          <p class="ml-3 p-3 card"><%= message.content %></p>
        </div>

        <% end %>
    </div>
    <div class="mt-2">
      <%= simple_form_for [@chat, @message], url: chat_messages_path(@chat), local: true  do |f| %>
        <%= f.input :content, label: Message %>
        <%= f.button :submit, "Send", class: "btn btn-flat" %>
      <% end %>
    </div>
    <script>
      var channel = pusher.subscribe('message-channel');
      channel.bind('new-message', function(data) {
          let { content, user, sent } = data;
          var div = document.getElementById('chat_section');
          div.innerHTML += `<p> ${user}: ${sent}</p>
          <p class="ml-3 p-3 card">${content}</p>`;
      });
    </script>
</div>
