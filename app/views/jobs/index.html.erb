<div class="row">
  <div class="container content-index col-7">
    <div class="container">
      <div class="row justify-content-between px-4 border-bottom">
        <h1>Available Jobs</h1>
        <%= link_to 'Display all jobs', jobs_path, class: 'btn btn-flat', id: 'display_all_jobs' %>
      </div>
      <div>
        <%= simple_form_for :search, url: jobs_path, method: :get do |f| %>
          <div class="form-group form-inline py-3 jobs_index_search">
            <div class="pr-2">
              <input class="form-control string required" type="text" placeholder="Job search" name="search[query]" id="search_query" />
            </div>
            <div>
              <button name="button" type="submit" class="btn btn-ghost btn-search">
                <i class="fas fa-search"></i> Search
              </button>
            </div>
          </div>
        <% end %>
      </div>
      <div>
        <% @jobs.each do |job|%>
          <% num_shifts = job.shifts.select { |shift| Time.parse(shift.start_time) > Time.now && !shift.user}.length  %>
          <% unless num_shifts <= 0 %>
            <%= render 'shared/show-jobs', job: job, num_shifts: num_shifts %>
          <% end %>
        <% end %>
      </div>
    </div>
  </div>
  <div class="col-5">
    <div
      id="map"
      style=" position: absolute;
      top: 0;
      bottom: 0;
      display: block;
      width: 100%;
      height: 91vh;"
      data-markers="<%= @markers.to_json %>"
      data-mapbox-api-key="<%= ENV['MAPBOX_API_KEY'] %>">
    </div>
  </div>
</div>
